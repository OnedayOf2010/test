<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>loginToolBar</title>
    <link href="../font/style.css" rel="stylesheet" type="text/css"/>
    <link href="../css/common.css" rel="stylesheet" type="text/css"/>
    <link href="../css/login-tool-bar.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="wrap body-opacity-bg bottom-border-radius" id="login_container">
    <!--<ul>-->
        <!--<li>-->
            <!--<label for="remberPassword">-->
                <!--<input type="checkbox" id="remberPassword" name="remberPassword"/><span>记住密码</span>-->
            <!--</label>-->
        <!--</li>-->
        <!--<li>-->
            <!--<a href="https://www.quanshi.com/register/showview/pc20_register.html" target="_blank" class="signUp">立即注册</a>-->
        <!--</li>-->
        <!--<li>-->
            <!--<label for="autoLogin">-->
                <!--<input type="checkbox" id="autoLogin" name="autoLogin"/><span>自动登录</span>-->
            <!--</label>-->
        <!--</li>-->
    <!--</ul>-->
</div>
<div id="msg">

</div>
<script src="jquery.js"></script>
<script>
//    var obj = new WxLogin({
//        id:"login_container",
////        appid: "wxcd8bdf39466fbc73",
//        appid: "wx3a9df678c0dc67ac",
//        scope: "snsapi_login",
//
//    redirect_uri: "https%3A%2F%2Funiformq.quanshi.com%2Frest%2Fuser%2Flogin%2FwxAuthorizeUser",
////        redirect_uri: "https%3A%2F%2Funiformq.quanshi.com%2Frest%2Fuser%2Flogin%2FwxAuthorizeUser",
////        redirect_uri: "https://uniformq.quanshi.com/rest/user/login/wxAuthorizeUser",
//        state: "",
//        style: "",
//        href:""
////        href: "http://files.cnblogs.com/files/onedayof2010/wxtest.css"
//    });
window.showMsg =function(msg){
  $("#msg").html(msg);
}
function creatIframe(url,$dom){
    var el = document.createElement("iframe");
    el.width="300px";
    el.height="400px";
    el.scrolling="no";
    el.allowTransparency="true";
    el.frameBorder="0";
    el.src=url;
    $dom.append(el);
}
function getUrlParam(url,name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
    var search =url.substring(url.indexOf("?")+1);
    var r = search.match(reg);
    if (r != null) return unescape(r[2]);
    return null;
}
!function(a,b){function d(a){var e,c=b.createElement("iframe"),d="https://open.weixin.qq.com/connect/qrconnect?appid="+a.appid+"&scope="+a.scope+"&redirect_uri="+a.redirect_uri+"&state="+a.state+"&login_type=jssdk";d+=a.style?"&style="+a.style:"",d+=a.href?"&href="+a.href:"",c.src=d,c.frameBorder="0",c.allowTransparency="true",c.scrolling="no",c.width="300px",c.height="400px",e=b.getElementById(a.id),e.innerHTML="",e.appendChild(c)}a.WxLogin=d}(window,document);
$.ajax({
    url:"https://uniform.quanshi.com/rest/user/login/getwxLoginUrl?yhy_p=d",
    type:"GET",
    dataType:"json",
    success:function(data){
       var url = data.result.loginUrl;

        var obj = new WxLogin({
            id:"login_container",
            appid: getUrlParam(url,"appid"),
            scope: "snsapi_login",

            redirect_uri: getUrlParam(url,"redirect_uri"),
            state: "",
            style: "",
            href: "https://raw.githubusercontent.com/OnedayOf2010/test/master/wxtest1.css"
        });
//        url+="&login_type=jssdk&href=https%3A%2F%2Fraw.githubusercontent.com%2FOnedayOf2010%2Ftest%2Fmaster%2Fwxtest.css"
//        creatIframe(url,$("#login_container"));

    }
})

</script>
</body>
</html>
